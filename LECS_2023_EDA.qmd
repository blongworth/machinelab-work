---
title: "2023 LECS data"
format: html
---

Exploratory plots of 2023 LECS data

## load libraries and read data

```{r}
library(tidyverse)
library(mlabtools)
library(scattermore)
library(xts)
library(dygraphs)

met <- read_csv("data/LECS_2023/surface_met.csv")
sfc_status <- read_csv("data/LECS_2023/surface_status.csv")
sfc_data <- read_csv("data/LECS_2023/surface_data.csv")
ldr_status <- read_csv("data/LECS_2023/lander_status.csv")
ldr_data <- read_csv("data/LECS_2023/lander_data.csv")
```

ADV had incorrect RTC setting. Adding an offset to convert to clock time

```{r}
# time offset in seconds
ts_offset <- 671628945

adv_status <- read_adv_status("data/LECS_2023/LECS_ADV/22.sen", ts_offset)
```

# ADV data

Data stored in internal ADV memory

## Battery Voltage

Resampled to 1 min means

```{r}
bat_ts <- xts(adv_status$bat, order.by = adv_status$timestamp)
bat_ts_res <- period.apply(bat_ts, endpoints(bat_ts, "mins"), FUN = mean)
bat_ts_res <- bat_ts_res[bat_ts_res[,1] < 19,]
dygraph(bat_ts_res) |> 
  dygraphs::dyRangeSelector()
```

## Temperature

Resampled to 1 min means

```{r}
temp_ts <- xts(adv_status$temp, order.by = adv_status$timestamp)
temp_ts_res <- period.apply(temp_ts, endpoints(temp_ts, "mins"), FUN = mean)
dygraph(temp_ts_res) |> 
  dygraphs::dyRangeSelector()
```


# Met data

## PAR

Something's up with the PAR readings. Is this something electrical related to the 4h transmit cycles?

```{r}
plot_ts(met, "par", timestamp = "ts")
```

### Wind Speed

Wind speed and direction look OK, if a little noisy

```{r}
plot_ts(met, "wind_speed", timestamp = "ts")
```

### Wind Dir

```{r}
plot_ts(met, "wind_dir", timestamp = "ts")
```
